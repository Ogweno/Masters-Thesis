# 2 simple                          
# 1   6.0000  3.4641  2.6900 35.0000  0.0000  0.0000  0.0000  0.0000  0.2500
# 2   8.0000  4.6188  3.3300  0.0000  0.0000  0.0000  0.0000  0.0000  0.2500
model=${1:-ak135} tmp=/tmp/temp$$
case "${model}" in
   ak135) cat << EOF > $tmp
      0.0000    5.80000    3.46000    2.72000   1456.201    600.000  0          
     20.0000    5.80000    3.46000    2.72000   1350.114    600.000  1
     20.0000    6.50000    3.85000    2.92000   1350.114    600.000  0
     35.0000    6.50000    3.85000    2.92000   1446.162    600.000  1
     35.0000    8.04000    4.48000    3.31070   1446.161    600.000  0
     41.0000    8.04071    4.48141    3.31620   1446.261    600.000 20
     71.0000    8.04424    4.48847    3.34085   1446.759    600.000  6
    120.0000    8.05000    4.50000    3.37130    195.520     80.000  5
    120.0000    8.05050    4.50000    3.37130    195.520     80.000  0
    171.0000    8.19169    4.51023    3.36430    195.639     80.000  5
    210.0000    8.30067    4.51840    3.32430    195.730     80.000  5
    210.0000    8.30106    4.51859    3.32440    195.730     80.000  0
    271.0000    8.52235    4.62878    3.37590    365.630    143.000  8
    371.0000    8.88776    4.80233    3.46830    370.849    143.000  8
    410.0000    9.03016    4.87018    3.50680    366.125    143.000  8
    410.0000    9.36013    5.08062    3.93170    366.125    143.000  0
    461.0000    9.53136    5.18851    3.92720    365.024    143.000  8
    561.0000    9.86736    5.40103    3.92180    363.046    143.000  8
    660.0000   10.19997    5.61038    3.92010    362.835    143.000  8
    660.0000   10.79116    5.96097    4.23880    362.835    143.000  0
    771.0000   11.07641    6.22304    4.36880    730.384    312.000  8
    771.0000   11.07676    6.22323    4.36910    730.384    312.000  0
EOF
      ;;
   ak135-mod) cat << EOF > $tmp
      0.0000    5.80000    3.46000    2.72000   1456.201    600.000  0          
     20.0000    5.80000    3.46000    2.72000   1350.114    600.000  1
     20.0000    6.50000    3.85000    2.92000   1350.114    600.000  0
     35.0000    6.50000    3.85000    2.92000   1446.162    600.000  1
     35.0000    8.04000    4.48000    3.31070   1446.161    600.000  0
     41.0000    8.04071    4.48141    3.31620   1446.261    600.000  5
     71.0000    8.04424    4.48847    3.34085   1446.759    600.000  6
    120.0000    8.05000    4.50000    3.37130    195.520     80.000  5
    120.0000    8.05050    4.50000    3.37130    195.520     80.000  0
    171.0000    8.19169    4.51023    3.36430    195.639     80.000  5
    210.0000    8.30067    4.51840    3.32430    195.730     80.000  5
    210.0000    8.30106    4.51859    3.32440    195.730     80.000  0
    271.0000    8.52235    4.62878    3.37590    365.630    143.000  8
    371.0000    8.88776    4.80233    3.46830    370.849    143.000  8
    410.0000    9.03016    4.87018    3.50680    366.125    143.000  8
    420.0000    9.36013    5.08062    3.93170    366.125    143.000 35
    461.0000    9.53136    5.18851    3.92720    365.024    143.000  8
    561.0000    9.86736    5.40103    3.92180    363.046    143.000  8
    660.0000   10.19997    5.61038    3.92010    362.835    143.000  8
    660.0000   10.79116    5.96097    4.23880    362.835    143.000  0
    771.0000   11.07641    6.22304    4.36880    730.384    312.000  8
    771.0000   11.07676    6.22323    4.36910    730.384    312.000  0
EOF
      ;;
   sp6) cat << EOF > $tmp
      0.0000    5.80000    3.36000    2.60000   1456.201    600.000  0          
     20.0000    5.80000    3.36000    2.60000   1350.114    600.000  1
     20.0000    6.50000    3.75000    2.90000   1350.114    600.000  0
     35.0000    6.50000    3.75000    2.90000   1446.162    600.000  1
     35.0000    8.04000    4.47000    3.38068   1446.161    600.000  0
     41.0000    8.04087    4.47218    3.38026   1446.261    600.000 20
     71.0000    8.04400    4.48300    3.37815   1446.759    600.000  6
    120.0000    8.05000    4.50000    3.37471    195.520     80.000  5
    120.0000    8.05000    4.50000    3.37471    195.520     80.000  0
    171.0000    8.19200    4.51000    3.36608    195.639     80.000  5
    210.0000    8.30000    4.51800    3.35949    195.730     80.000  5
    210.0000    8.30000    4.52200    3.43578    195.730     80.000  0
    271.0000    8.52300    4.62800    3.46856    365.630    143.000  8
    371.0000    8.88800    4.80200    3.52230    370.849    143.000  8
    410.0000    9.03000    4.87000    3.54326    366.125    143.000  8
    410.0000    9.37500    5.09600    3.72375    366.125    143.000  0
    461.0000    9.54640    5.20383    3.79141    365.024    143.000  8
    561.0000    9.88240    5.41578    3.92408    363.046    143.000  8
    660.0000   10.21500    5.62600    3.99212    362.835    143.000  8
    660.0000   10.77000    5.98800    4.38074    362.835    143.000  0
    771.0000   11.06600    6.21300    4.44320    730.384    312.000  8
    771.0000   11.06600    6.21300    4.44320    730.384    312.000  0
EOF
      ;;
   *) echo "**Don't recognize ${model} -- quitting." ; exit 1
      ;;
esac
awk 'BEGIN{nl=0; z=0; mod="'"${model}"'"}
$7 == 0{z=$1; vp=$2; vs=$3; rho=$4; qp=$5; qs=$6}
$7 > 0{n=$7; dz=$1-z
   if (dz > 0) {
      dvp=$2-vp; dvs=$3-vs; drho=$4-rho; dqp=$5-qp; dqs=$6-qs
      if (dvp+dvs+drho == 0.0) {
         nn=nl+1; lvp[nn]=vp; lvs[nn]=vs; lrho[nn]=rho; lqp[nn]=qp; lqs[nn]=qs
	 lth[nn]=dz
      } else for(i=0; i<n; i++) {
         nn=nl+i+1
         lvp[nn]=vp+i*dvp/n; lvs[nn]=vs+i*dvs/n; lrho[nn]=rho+i*drho/n
         lqp[nn]=qp+i*dqp/n; lqs[nn]=qs+i*dqs/n; lth[nn]=dz/n
      }
      nl=nn
   }
   z=$1; vp=$2; vs=$3; rho=$4; qp=$5; qs=$6
}
END{
   nl+=1; z=0
   lth[nl]=0.0; lvp[nl]=vp; lvs[nl]=vs; lrho[nl]=rho; lqp[nl]=qp; lqs[nl]=qs
   fmt="%3d %8.4f %7.4f %7.4f %7.4f %7.4f %7.4f %7.4f %7.2f %7.2f %3d\n"
   printf "%3d %s\n",nl,mod
   for(i=1;i<=nl;i++) {
#     printf fmt,i,lvp[i],lvs[i],lrho[i],lth[i],lqp[i],lqs[i],0.,0.,0.25
#     printf fmt,i,lvp[i],lvs[i],lrho[i],lth[i],0.0,0.0,0.,0.,0.25
      printf fmt,i,lvp[i],lvs[i],lrho[i],lth[i],0.0,0.0,0.,lqp[i],lqs[i],z
      z+=lth[i]
   }
}' $tmp
/bin/rm -f $tmp
